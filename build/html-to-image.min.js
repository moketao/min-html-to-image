"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).htmlToImage=e()}}(function(){return function u(i,a,c){function l(t,e){if(!a[t]){if(!i[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=a[t]={exports:{}};i[t][0].call(o.exports,function(e){return l(i[t][1][e]||e)},o,o.exports,u,i,a,c)}return a[t].exports}for(var s="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){var n=e.style;return t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=t.width+"px"),t.height&&(n.height=t.height+"px"),t.style&&Object.assign(n,t.style),e}},{}],2:[function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./utils"),i=r(e("./clonePseudoElements"));function o(e){return e instanceof HTMLCanvasElement?a.createImage(e.toDataURL()):e.tagName&&"svg"===e.tagName.toLowerCase()?Promise.resolve(e).then(function(e){return a.svgToDataURL(e)}).then(a.createImage):Promise.resolve(e.cloneNode(!1))}function c(o,u){return u instanceof Element?Promise.resolve().then(function(){return e=o,t=u,n=window.getComputedStyle(e),r=t.style,void(n.cssText?r.cssText=n.cssText:a.toArray(n).forEach(function(e){r.setProperty(e,n.getPropertyValue(e),n.getPropertyPriority(e))}));var e,t,n,r}).then(function(){return i.default(o,u)}).then(function(){return t=u,(e=o)instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),void(e instanceof HTMLInputElement&&t.setAttribute("value",e.value));var e,t}).then(function(){return u}):u}function l(u,i,e){return e||!i||i(u)?Promise.resolve(u).then(o).then(function(e){return t=u,n=e,r=i,0===(o=a.toArray(t.childNodes)).length?Promise.resolve(n):o.reduce(function(e,t){return e.then(function(){return l(t,r)}).then(function(e){e&&n.appendChild(e)})},Promise.resolve()).then(function(){return n});var t,n,r,o}).then(function(e){return c(u,e)}):Promise.resolve(null)}n.default=l},{"./clonePseudoElements":3,"./utils":10}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var c=e("./utils");function a(e,t,n){var r,o,u,i="."+e+":"+t,a=n.cssText?(u=(o=n).getPropertyValue("content"),o.cssText+" content: "+u+";"):(r=n,c.toArray(r).map(function(e){return e+": "+r.getPropertyValue(e)+(r.getPropertyPriority(e)?" !important":"")+";"}).join(" "));return document.createTextNode(i+"{"+a+"}")}n.default=function(t,n){[":before",":after"].forEach(function(e){return function(e,t,n){var r=window.getComputedStyle(e,n),o=r.getPropertyValue("content");if(""!==o&&"none"!==o){var u=c.uuid(),i=document.createElement("style");i.appendChild(a(u,n,r)),t.className=t.className+" "+u,t.appendChild(i)}}(t,n,e)})}},{"./utils":10}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./utils");n.default=function(e,t,n){var r="http://www.w3.org/2000/svg",o=document.createElementNS(r,"svg"),u=document.createElementNS(r,"foreignObject");return o.setAttributeNS("","width",""+t),o.setAttributeNS("","height",""+n),u.setAttributeNS("","width","100%"),u.setAttributeNS("","height","100%"),u.setAttributeNS("","x","0"),u.setAttributeNS("","y","0"),u.setAttributeNS("","externalResourcesRequired","true"),o.appendChild(u),u.appendChild(e),i.svgToDataURL(o)}},{"./utils":10}],5:[function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var u=e("./utils"),i=r(e("./getBlobFromURL")),a=r(e("./embedResources"));function c(e,o){return e instanceof Element?Promise.resolve(e).then(function(e){return n=o,(r=(t=e).style.getPropertyValue("background"))?Promise.resolve(r).then(function(e){return a.default(e,null,n)}).then(function(e){return t.style.setProperty("background",e,t.style.getPropertyPriority("background")),t}):Promise.resolve(t);var t,n,r}).then(function(e){return t=o,(r=e)instanceof HTMLImageElement&&!u.isDataUrl(r.src)?Promise.resolve(r.src).then(function(e){return i.default(e,t)}).then(function(e){return u.toDataURL(e,u.getMimeType(r.src))}).then(function(n){return new Promise(function(e,t){r.onload=e,r.onerror=t,r.src=n})}).then(function(){return r},function(){return r}):Promise.resolve(r);var r,t}).then(function(e){return t=e,n=o,r=u.toArray(t.childNodes).map(function(e){return c(e,n)}),Promise.all(r).then(function(){return t});var t,n,r}):Promise.resolve(e)}n.default=c},{"./embedResources":6,"./getBlobFromURL":8,"./utils":10}],6:[function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var u=r(e("./getBlobFromURL")),i=e("./utils"),o=/url\((['"]?)([^'"]+?)\1\)/g;function a(e){var r=[];return e.replace(o,function(e,t,n){return r.push(n),e}),r.filter(function(e){return!i.isDataUrl(e)})}function c(t,n,e,r){var o=e?function(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;var n=document.implementation.createHTMLDocument(),r=n.createElement("base"),o=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(o),t&&(r.href=t),o.href=e,o.href}(n,e):n;return Promise.resolve(o).then(function(e){return u.default(e,r)}).then(function(e){return i.toDataURL(e,i.getMimeType(n))}).then(function(e){return t.replace(new RegExp("(url\\(['\"]?)("+n.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")+")(['\"]?\\))","g"),"$1"+e+"$3")}).then(function(e){return e},function(){return o})}function l(e){return-1!==e.search(o)}n.shouldEmbed=l,n.default=function(t,n,r){return l(t)?Promise.resolve(t).then(a).then(function(e){return e.reduce(function(e,t){return e.then(function(e){return c(e,t,n,r)})},Promise.resolve(t))}):Promise.resolve(t)}},{"./getBlobFromURL":8,"./utils":10}],7:[function(e,t,n){var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(n,"__esModule",{value:!0});var u=e("./utils"),o=r(e("./embedResources"));function i(e){if(void 0===e)return[];var t=e,n=[],r=new RegExp("(\\/\\*[\\s\\S]*?\\*\\/)","gi");t=t.replace(r,"");for(var o,u=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");null!==(o=u.exec(t));)n.push(o[0]);t=t.replace(u,"");for(var i=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");null!==(o=i.exec(t));)n.push(o[0]);return n}function a(t){return fetch(t).then(function(e){return{url:t,cssText:e.text()}},function(e){console.log("ERROR FETCHING CSS: ",e.toString())})}function c(n){return n.cssText.then(function(e){var o=e,t=(o.match(/url\([^)]+\)/g)||[]).map(function(r){var t=r.replace(/url\(([^]+)\)/g,"$1");if(!t.startsWith("https://")){var e=n.url;t=new URL(t,e).href}return new Promise(function(n,e){fetch(t).then(function(e){return e.blob()}).then(function(e){var t=new FileReader;t.addEventListener("load",function(e){o=o.replace(r,"url("+t.result+")"),n([r,t.result])}),t.readAsDataURL(e)}).catch(e)})});return Promise.all(t).then(function(){return o})})}function l(r){var n=[],o=[];return r.forEach(function(t){if("cssRules"in t)try{u.toArray(t.cssRules).forEach(function(e){e.type===CSSRule.IMPORT_RULE&&o.push(a(e.href).then(c).then(function(e){i(e).forEach(function(e){t.insertRule(e,t.cssRules.length)})}).catch(function(e){console.log("Error loading remote css",e.toString())}))})}catch(e){var n=r.find(function(e){return null===e.href})||document.styleSheets[0];null!=t.href&&o.push(a(t.href).then(c).then(function(e){i(e).forEach(function(e){n.insertRule(e,t.cssRules.length)})}).catch(function(e){console.log("Error loading remote stylesheet",e.toString())})),console.log("Error inlining remote css file",e.toString())}}),Promise.all(o).then(function(){return r.forEach(function(t){if("cssRules"in t)try{u.toArray(t.cssRules).forEach(function(e){n.push(e)})}catch(e){console.log("Error while reading CSS rules from "+t.href,e.toString())}}),n})}function s(e){return e.filter(function(e){return e.type===CSSRule.FONT_FACE_RULE}).filter(function(e){return o.shouldEmbed(e.style.getPropertyValue("src"))})}function f(n){return new Promise(function(e,t){n.ownerDocument||t(new Error("Provided element is not within a Document")),e(u.toArray(n.ownerDocument.styleSheets))}).then(l).then(s)}n.parseWebFontRules=f,n.default=function(r,n){return f(r).then(function(e){return Promise.all(e.map(function(e){var t=e.parentStyleSheet?e.parentStyleSheet.href:null;return o.default(e.cssText,t,n)}))}).then(function(e){return e.join("\n")}).then(function(e){var t=document.createElement("style"),n=document.createTextNode(e);return t.appendChild(n),r.firstChild?r.insertBefore(t,r.firstChild):r.appendChild(t),r})}},{"./embedResources":6,"./utils":10}],8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=e("./utils");n.default=function(o,u){return u.cacheBust&&(o+=(/\?/.test(o)?"&":"?")+(new Date).getTime()),(window.fetch?window.fetch(o).then(function(e){return e.blob()}).then(function(r){return new Promise(function(e,t){var n=new FileReader;n.onloadend=function(){return e(n.result)},n.onerror=t,n.readAsDataURL(r)})}).then(i.getDataURLContent).catch(function(){return new Promise(function(e,t){t()})}):new Promise(function(t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var e=new FileReader;e.onloadend=function(){t(i.getDataURLContent(e.result))},e.readAsDataURL(r.response)}else n(new Error("Failed to fetch resource: "+o+", status: "+r.status))},r.ontimeout=function(){n(new Error("Timeout of 30000ms occured while fetching resource: "+o))},r.responseType="blob",r.timeout=3e4,r.open("GET",o,!0),r.send()})).catch(function(e){var t="";if(u.imagePlaceholder){var n=u.imagePlaceholder.split(/,/);n&&n[1]&&(t=n[1])}var r="Failed to fetch resource: "+o;return e&&(r="string"==typeof e?e:e.message),r&&console.error(r),t})}},{"./utils":10}],9:[function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var u=r(e("./cloneNode")),i=r(e("./embedWebFonts")),a=r(e("./embedImages")),c=r(e("./createSvgDataURL")),l=r(e("./applyStyleWithOptions")),s=e("./utils");function f(e,t){return void 0===t&&(t={}),{width:t.width||s.getNodeWidth(e),height:t.height||s.getNodeHeight(e)}}function o(e,t){void 0===t&&(t={});var n=f(e,t),r=n.width,o=n.height;return u.default(e,t.filter,!0).then(function(e){return i.default(e,t)}).then(function(e){return a.default(e,t)}).then(function(e){return l.default(e,t)}).then(function(e){return c.default(e,r,o)})}function d(a,c){return void 0===c&&(c={}),o(a,c).then(s.createImage).then(s.delay(100)).then(function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=s.getPixelRatio(),o=f(a,c),u=o.width,i=o.height;return t.width=u*r,t.height=i*r,t.style.width=""+u,t.style.height=""+i,n.scale(r,r),c.backgroundColor&&(n.fillStyle=c.backgroundColor,n.fillRect(0,0,t.width,t.height)),n.drawImage(e,0,0),t})}function h(e,t){void 0===t&&(t={});var n=f(e,t),r=n.width,o=n.height;return d(e,t).then(function(e){return e.getContext("2d").getImageData(0,0,r,o).data})}function g(e,t){return void 0===t&&(t={}),d(e,t).then(function(e){return e.toDataURL()})}function m(e,t){return void 0===t&&(t={}),d(e,t).then(function(e){return e.toDataURL("image/jpeg",t.quality||1)})}function p(e,t){return void 0===t&&(t={}),d(e,t).then(s.canvasToBlob)}n.toSvgDataURL=o,n.toCanvas=d,n.toPixelData=h,n.toPng=g,n.toJpeg=m,n.toBlob=p,n.default={toSvgDataURL:o,toCanvas:d,toPixelData:h,toPng:g,toJpeg:m,toBlob:p}},{"./applyStyleWithOptions":1,"./cloneNode":2,"./createSvgDataURL":4,"./embedImages":5,"./embedWebFonts":7,"./utils":10}],10:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var r,o="application/font-woff",u="image/jpeg",i={woff:o,woff2:o,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:u,jpeg:u,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"};function a(e){var t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function c(e){var t=a(e).toLowerCase();return i[t]||""}function l(r){return new Promise(function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=t,n.crossOrigin="anonymous",n.src=r})}function s(e){return e.split(/,/)[1]}function f(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}function d(){return window.devicePixelRatio||1}n.uuid=(r=0,function(){return r+=1,"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+r}),n.parseExtension=a,n.getMimeType=c,n.delay=function(n){return function(t){return new Promise(function(e){setTimeout(function(){e(t)},n)})}},n.createImage=l,n.isDataUrl=function(e){return-1!==e.search(/^(data:)/)},n.toDataURL=function(e,t){return"data:"+t+";base64,"+e},n.getDataURLContent=s,n.canvasToBlob=function(t){return t.toBlob?new Promise(function(e){t.toBlob(e)}):(u=t,new Promise(function(e){for(var t=window.atob(u.toDataURL().split(",")[1]),n=t.length,r=new Uint8Array(n),o=0;o<n;o+=1)r[o]=t.charCodeAt(o);e(new Blob([r],{type:"image/png"}))}));var u},n.toArray=function(e){for(var t=[],n=0,r=e.length;n<r;n+=1)t.push(e[n]);return t},n.getNodeWidth=function(e){var t=f(e,"border-left-width"),n=f(e,"border-right-width");return e.scrollWidth+t+n},n.getNodeHeight=function(e){var t=f(e,"border-top-width"),n=f(e,"border-bottom-width");return e.scrollHeight+t+n},n.getPixelRatio=d,n.svgToDataURL=function(e){return Promise.resolve().then(function(){return(new XMLSerializer).serializeToString(e)}).then(encodeURIComponent).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})},n.getBlobFromImageURL=function(i){return l(i).then(function(e){var t=e.width,n=e.height,r=document.createElement("canvas"),o=r.getContext("2d"),u=d();return r.width=t*u,r.height=n*u,r.style.width=""+t,r.style.height=""+n,o.scale(u,u),o.drawImage(e,0,0),s(r.toDataURL(c(i)))})}},{}]},{},[9])(9)});